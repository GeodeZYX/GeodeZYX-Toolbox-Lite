#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Wed Mar  7 14:52:10 2018

@author: psakicki
"""

from megalib import *

# sat19006.sum_full
# Whose kind of files are stored in weekWWWW_store
# /dsk/grsp1/cf_orb/acc_combi/combi/final/weekWWWW_store
L1 = [0.724793E-02,
0.629801E-02,
0.785491E-02,
0.787034E-02,
0.631733E-02,
0.140538E-01,
0.194821E-01,
0.584029E-02,
0.550154E-02,
0.107512E-01,
0.102564E-01,
0.812503E-02,
0.804017E-02,
0.773598E-02,
0.828735E-02,
0.118192E-01,
0.700994E-02,
0.840778E-02,
0.840162E-02,
0.613016E-02,
0.981212E-02,
0.691226E-02,
0.168727E-01,
0.918973E-02,
0.755049E-02,
0.122119E-01,
0.758796E-02,
0.866339E-02,
0.145546E-01,
0.112983E-01,
0.833533E-02]

L2 = [7,
 5,
 7,
 6,
 6,
17,
 7,
10,
16,
 6,
 3,
 4,
 7,
 3,
 6,
 4,
 8,
 3,
 5,
 5,
 7,
 5,
 7,
10,
 4,
 7,
 4,
 6,
 4,
 9,
 4,
 4]



L3 = [12,
13,
15,
14,
14,
21,
14,
11,
14,
15,
 7,
14,
13,
18,
16,
16,
 8,
13,
12,
 7,
12,
10,
34,
 9,
12,
29,
10,
10,
18,
22,
11]

L4 = [12,
13,
15,
14,
14,
21,
14,
11,
14,
15,
 7,
14,
13,
18,
16,
16,
 8,
13,
12,
 7,
12,
10,
34,
 9,
12,
29,
10,
10,
18,
22,
11,
30,
48,
17,
22]


L5 = [ 670,
 179,
2456,
 541,
 334,
 688,
 217,
2831,
3017,
1638,
 370,
 446,
 276,
 249,
 269,
 376,
 578,
 309,
 199,
 397,
 336,
 290,
 178,
1159,
 206,
 262,
 173,
 420,
 454,
 249,
1114]

### co_19577.sum
#Table 3.1957.1   GPS week: 1957   Day: 1   MJD: 57944.000   DOY: 191
L6 = [615,
 508,
 899,
 555,
 435,
 436,
 890,
 487,
 504,
 410,
 362,
 543,
 805,
 606,
 603,
 688,
 488,
 538,
 597,
1022,
 595,
 624,
1395,
 501,
 344,
 477,
 297,
 401,
 214,
 648,
1020]

# sat20350.sum_full
# In the bottom of this file
# p1_

L7 = [0.821561E-02,
0.666891E-02,
0.450805E-02,
0.678068E-02,
0.134574E-01,
0.619237E-02,
0.111579E-01,
0.958728E-02,
0.947181E-02,
0.803747E-02,
0.847463E-02,
0.949500E-02,
0.130250E-01,
0.747103E-02,
0.159554E-01,
0.734879E-02,
0.990703E-02,
0.897296E-02,
0.126528E-01,
0.107414E-01,
0.665793E-02,
0.540796E-02,
0.955836E-02,
0.139447E-01,
0.215395E-01,
0.102659E-01,
0.738094E-02,
0.132924E-01,
0.634857E-02,
0.126331E-01,
0.128645E-01,
0.138365E-01,
0.252952E-01,
0.207288E-01,
0.102125E-01,
0.174574E-01,
0.131975E-01,
0.141134E-01,
0.108647E-01,
0.138305E-01,
0.128122E-01,
0.890539E-02,
0.187707E-01,
0.112146E-01,
0.186537E-01,
0.987509E-02,
0.176234E-01,
0.126009E-01,
0.226634E-01,
0.282938E-01,
0.359167E-01]

# p2_
L8 = [0.833522E-02,
0.747394E-02,
0.670776E-02,
0.519730E-02,
0.147736E-01,
0.862652E-02,
0.619631E-02,
0.100761E-01,
0.626779E-02,
0.124361E-01,
0.612067E-02,
0.640414E-02,
0.808859E-02,
0.783281E-02,
0.922644E-02,
0.421780E-02,
0.142783E-01,
0.611735E-02,
0.884626E-02,
0.827124E-02,
0.671881E-02,
0.647331E-02,
0.896343E-02,
0.113947E-01,
0.189008E-01,
0.598671E-02,
0.559525E-02,
0.744258E-02,
0.693118E-02,
0.677741E-02,
0.649839E-02,
0.104641E-01,
0.213299E-01,
0.143039E-01,
0.997154E-02,
0.112220E-01,
0.108554E-01,
0.116191E-01,
0.171706E-01,
0.702650E-02,
0.115986E-01,
0.903873E-02,
0.183971E-01,
0.119993E-01,
0.188383E-01,
0.150568E-01,
0.160645E-01,
0.134655E-01,
0.143791E-01,
0.202536E-01,
0.289313E-01]

L9 = [0.548728E-02,
0.671640E-02,
0.697645E-02,
0.776875E-02,
0.865453E-02,
0.844447E-02,
0.894628E-02,
0.973195E-02,
0.782019E-02,
0.810981E-02,
0.968211E-02,
0.668161E-02,
0.784557E-02,
0.102526E-01,
0.759938E-02,
0.113118E-01,
0.949549E-02,
0.107330E-01,
0.798262E-02,
0.829459E-02,
0.896748E-02,
0.716108E-02,
0.884220E-02,
0.712521E-02,
0.104053E-01,
0.799896E-02,
0.727843E-02,
0.899124E-02,
0.681443E-02,
0.991621E-02,
0.112049E-01]


#p1_ GPS ONLY
L10 = [0.821561E-02,
0.666891E-02,
0.450805E-02,
0.678068E-02,
0.134574E-01,
0.619237E-02,
0.111579E-01,
0.958728E-02,
0.947181E-02,
0.803747E-02,
0.847463E-02,
0.949500E-02,
0.130250E-01,
0.747103E-02,
0.159554E-01,
0.734879E-02,
0.990703E-02,
0.897296E-02,
0.126528E-01,
0.107414E-01,
0.665793E-02,
0.540796E-02,
0.955836E-02,
0.139447E-01,
0.215395E-01,
0.102659E-01,
0.738094E-02,
0.132924E-01,
0.634857E-02,
0.126331E-01,
0.128645E-01]

L = L10

L = np.array(L)

W         = (L/np.sum(L))
Winv      = 1/W
Winvnorm  = Winv / sum(Winv)
sum(Winvnorm)
Winv2     = 1 / (W**2)
Winvnorm2 = Winv2 / sum(Winv2)
sum(Winvnorm2)

Www  = 1 / len(L)

np.mean(L) - L 

Wfin = Winvnorm2

#np.sqrt(np.nanmean(np.square(A)))
print(geok.rms_mean(L))

print(np.sqrt(np.sum( Wfin * np.square(L))))


## CONCLUSION 
# RMS  : regular RMS of the column 
# but regular RMS of the column deals only with GPS !!!! (constated 1901)
# thus, a manual RMS is better !!!

# WRMS : no way to find the way it is computed ... but WRMS ~ RMS 
#in immense majority



#COMBINATION OF IGS PROCESSING ORBITS
#GPS week: 2035   Day: 0   MJD: 58489.000 Length:  1.0 day(s)
#
# PRN |      brd            brf            bri            cor            igr            p1_            p2_            p3_
#-----|---------------------------------------------------------------------------------------------------------------------------------------------------------|-------------
#----
#   1 |   0.628278E+00   0.000000E+00   0.000000E+00   0.292625E-02   0.548728E-02   0.821561E-02   0.833522E-02   0.854674E-02   0.591312E-02
#   2 |   0.145790E+01   0.000000E+00   0.000000E+00   0.529000E-02   0.671640E-02   0.666891E-02   0.747394E-02   0.104123E-01   0.583984E-02
#   3 |   0.471474E+00   0.000000E+00   0.000000E+00   0.368811E-02   0.697645E-02   0.450805E-02   0.670776E-02   0.879534E-02   0.484565E-02
#   5 |   0.435804E+00   0.000000E+00   0.000000E+00   0.462580E-02   0.776875E-02   0.678068E-02   0.519730E-02   0.742496E-02   0.456161E-02
#   6 |   0.727064E+00   0.000000E+00   0.000000E+00   0.656404E-02   0.865453E-02   0.134574E-01   0.147736E-01   0.768542E-02   0.888786E-02
#   7 |   0.469230E+00   0.000000E+00   0.000000E+00   0.464314E-02   0.844447E-02   0.619237E-02   0.862652E-02   0.844208E-02   0.556531E-02
#   8 |   0.570617E+00   0.000000E+00   0.000000E+00   0.421259E-02   0.894628E-02   0.111579E-01   0.619631E-02   0.914264E-02   0.630960E-02
#   9 |   0.702588E+00   0.000000E+00   0.000000E+00   0.331935E-02   0.973195E-02   0.958728E-02   0.100761E-01   0.873239E-02   0.673700E-02
#  10 |   0.557270E+00   0.000000E+00   0.000000E+00   0.426338E-02   0.782019E-02   0.947181E-02   0.626779E-02   0.109476E-01   0.631990E-02
#  11 |   0.546080E+00   0.000000E+00   0.000000E+00   0.405078E-02   0.810981E-02   0.803747E-02   0.124361E-01   0.175899E-01   0.929969E-02
#  12 |   0.331761E+00   0.000000E+00   0.000000E+00   0.122308E-01   0.968211E-02   0.847463E-02   0.612067E-02   0.994576E-02   0.579301E-02
#  13 |   0.697587E+00   0.000000E+00   0.000000E+00   0.407783E-02   0.668161E-02   0.949500E-02   0.640414E-02   0.851592E-02   0.575677E-02
#  14 |   0.583271E+00   0.000000E+00   0.000000E+00   0.583673E-02   0.784557E-02   0.130250E-01   0.808859E-02   0.101217E-01   0.741464E-02
#  15 |   0.430600E+00   0.000000E+00   0.000000E+00   0.684981E-02   0.102526E-01   0.747103E-02   0.783281E-02   0.124834E-01   0.664521E-02
#  16 |   0.129542E+01   0.000000E+00   0.000000E+00   0.442910E-02   0.759938E-02   0.159554E-01   0.922644E-02   0.121028E-01   0.888460E-02
#  17 |   0.741593E+00   0.000000E+00   0.000000E+00   0.524090E-02   0.113118E-01   0.734879E-02   0.421780E-02   0.789632E-02   0.463147E-02
#  18 |   0.166012E+01   0.000000E+00   0.000000E+00   0.653221E-02   0.949549E-02   0.990703E-02   0.142783E-01   0.152771E-01   0.946310E-02
#  19 |   0.222287E+00   0.000000E+00   0.000000E+00   0.450792E-02   0.107330E-01   0.897296E-02   0.611735E-02   0.810712E-02   0.546737E-02
#  20 |   0.594513E+00   0.000000E+00   0.000000E+00   0.420136E-02   0.798262E-02   0.126528E-01   0.884626E-02   0.956587E-02   0.736236E-02
#  21 |   0.534513E+00   0.000000E+00   0.000000E+00   0.480147E-02   0.829459E-02   0.107414E-01   0.827124E-02   0.140605E-01   0.783326E-02
#  22 |   0.410187E+00   0.000000E+00   0.000000E+00   0.599066E-02   0.896748E-02   0.665793E-02   0.671881E-02   0.122226E-01   0.618807E-02
#  23 |   0.791187E+00   0.000000E+00   0.000000E+00   0.344836E-02   0.716108E-02   0.540796E-02   0.647331E-02   0.679983E-02   0.442613E-02
#  24 |   0.506290E+00   0.000000E+00   0.000000E+00   0.494078E-02   0.884220E-02   0.955836E-02   0.896343E-02   0.993656E-02   0.668781E-02
#  25 |   0.441396E+00   0.000000E+00   0.000000E+00   0.668204E-02   0.712521E-02   0.139447E-01   0.113947E-01   0.802746E-02   0.808016E-02
#  26 |   0.624480E+00   0.000000E+00   0.000000E+00   0.655618E-02   0.104053E-01   0.215395E-01   0.189008E-01   0.100675E-01   0.125198E-01
#  27 |   0.744918E+00   0.000000E+00   0.000000E+00   0.421076E-02   0.799896E-02   0.102659E-01   0.598671E-02   0.851479E-02   0.588171E-02
#  28 |   0.394572E+00   0.000000E+00   0.000000E+00   0.588698E-02   0.727843E-02   0.738094E-02   0.559525E-02   0.123809E-01   0.615617E-02
#  29 |   0.753419E+00   0.000000E+00   0.000000E+00   0.509331E-02   0.899124E-02   0.132924E-01   0.744258E-02   0.137332E-01   0.820423E-02
#  30 |   0.487209E+00   0.000000E+00   0.000000E+00   0.562333E-02   0.681443E-02   0.634857E-02   0.693118E-02   0.715473E-02   0.482334E-02
#  31 |   0.764781E+00   0.000000E+00   0.000000E+00   0.578832E-02   0.991621E-02   0.126331E-01   0.677741E-02   0.104768E-01   0.712830E-02
#  32 |   0.587174E+00   0.000000E+00   0.000000E+00   0.684533E-02   0.112049E-01   0.128645E-01   0.649839E-02   0.106519E-01   0.718465E-02
# 201 |   0.000000E+00   0.294853E+00   0.294853E+00   0.145939E-01   0.000000E+00   0.138365E-01   0.104641E-01   0.154052E-01   0.934151E-02
# 202 |   0.000000E+00   0.284867E+00   0.284867E+00   0.859469E-02   0.000000E+00   0.252952E-01   0.213299E-01   0.139740E-01   0.147480E-01
# 203 |   0.000000E+00   0.292902E+00   0.292902E+00   0.215828E-01   0.000000E+00   0.207288E-01   0.143039E-01   0.163817E-01   0.121622E-01
# 204 |   0.000000E+00   0.266212E+00   0.266212E+00   0.158141E-01   0.000000E+00   0.102125E-01   0.997154E-02   0.199281E-01   0.978553E-02
# 205 |   0.000000E+00   0.234059E+00   0.234059E+00   0.142783E-01   0.000000E+00   0.174574E-01   0.112220E-01   0.202726E-01   0.116124E-01
# 207 |   0.000000E+00   0.242924E+00   0.242924E+00   0.399805E-01   0.000000E+00   0.131975E-01   0.108554E-01   0.196099E-01   0.104146E-01
# 208 |   0.000000E+00   0.208340E+00   0.208340E+00   0.242457E-01   0.000000E+00   0.141134E-01   0.116191E-01   0.214553E-01   0.112788E-01
# 209 |   0.000000E+00   0.259349E+00   0.259349E+00   0.253723E-01   0.000000E+00   0.108647E-01   0.171706E-01   0.254199E-01   0.131385E-01
# 211 |   0.000000E+00   0.298289E+00   0.298289E+00   0.163743E-01   0.000000E+00   0.138305E-01   0.702650E-02   0.161584E-01   0.891781E-02
# 212 |   0.000000E+00   0.285909E+00   0.285909E+00   0.157730E-01   0.000000E+00   0.128122E-01   0.115986E-01   0.176678E-01   0.994984E-02
# 214 |   0.000000E+00   0.311680E+00   0.311680E+00   0.112994E-01   0.000000E+00   0.890539E-02   0.903873E-02   0.143415E-01   0.770184E-02
# 218 |   0.000000E+00   0.395930E+00   0.395930E+00   0.145870E-01   0.000000E+00   0.187707E-01   0.183971E-01   0.186648E-01   0.131511E-01
# 219 |   0.000000E+00   0.363230E+00   0.363230E+00   0.498557E-01   0.000000E+00   0.112146E-01   0.119993E-01   0.178823E-01   0.978843E-02
# 221 |   0.000000E+00   0.313202E+00   0.313202E+00   0.263066E-01   0.000000E+00   0.186537E-01   0.188383E-01   0.132723E-01   0.122131E-01
# 224 |   0.000000E+00   0.255491E+00   0.255491E+00   0.115268E-01   0.000000E+00   0.987509E-02   0.150568E-01   0.180149E-01   0.103735E-01
# 225 |   0.000000E+00   0.262883E+00   0.262883E+00   0.160675E-01   0.000000E+00   0.176234E-01   0.160645E-01   0.146840E-01   0.114438E-01
# 226 |   0.000000E+00   0.278530E+00   0.278530E+00   0.241265E-01   0.000000E+00   0.126009E-01   0.134655E-01   0.248154E-01   0.123744E-01
# 227 |   0.000000E+00   0.287921E+00   0.287921E+00   0.212824E-01   0.000000E+00   0.226634E-01   0.143791E-01   0.206696E-01   0.136338E-01
# 230 |   0.000000E+00   0.260857E+00   0.260857E+00   0.121794E-01   0.000000E+00   0.282938E-01   0.202536E-01   0.952960E-02   0.147932E-01
# 231 |   0.000000E+00   0.289812E+00   0.289812E+00   0.151597E-01   0.000000E+00   0.359167E-01   0.289313E-01   0.127881E-01   0.197080E-01
#-----|---------------------------------------------------------------------------------------------------------------------------------------------------------|-------------
#----
#RMS  |   0.718079E+00            NaN            NaN   0.552901E-02   0.860947E-02   0.105401E-01   0.885952E-02   0.104869E-01
#WRMS |   0.718079E+00            NaN            NaN   0.517671E-02   0.853504E-02   0.101941E-01   0.821512E-02   0.104869E-01
